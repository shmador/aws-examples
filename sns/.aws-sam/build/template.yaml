AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Resources:
  MySNSTopic:
    Type: AWS::SNS::Topic
  MyFunction:
    Type: AWS::Serverless::Function
    Properties:
      Handler: index.handler
      Runtime: python3.9
      PackageType: Zip
      InlineCode: "# Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n\
        # SPDX-License-Identifier: Apache-2.0\ndef lambda_handler(event, context):\n\
        \    for record in event['Records']:\n        process_message(record)\n  \
        \  print(\"done\")\n\ndef process_message(record):\n    try:\n        message\
        \ = record['Sns']['Message']\n        print(f\"Processed message {message}\"\
        )\n        # TODO; Process your record here\n\n    except Exception as e:\n\
        \        print(\"An error occurred\")\n        raise e\n"
      Events:
        SNSEvent:
          Type: SNS
          Properties:
            Topic:
              Ref: MYSNSTopic
Outputs:
  TopicArn:
    Description: The ARN of the created SNS topic
    Value:
      Ref: MySNSTopic
  TopicName:
    Description: The name of the created SNS topic
    Value: SampleTopic
